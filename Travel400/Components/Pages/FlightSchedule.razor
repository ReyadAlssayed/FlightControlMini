@page "/FlightSchedule"
@using Travel400.Model
@using Travel400.Service
@inject SupabaseService SupabaseService

<link href="css/FlightSchedule.css" rel="stylesheet" />

<h3 class="page-title">✈️ جدول الرحلات - رياض ترافل</h3>

@if (bookings == null)
{
    <p>⏳ جاري تحميل الرحلات...</p>
}
else if (!bookings.Any())
{
    <p>🚫 لا توجد رحلات حالياً.</p>
}
else
{
    <table class="flight-table" dir="rtl">
        <thead>
            <tr>
                <th>الدولة</th>
                <th>تاريخ الرحلة</th>
                <th>وقت الرحلة</th>
                <th>عدد الركاب الكلي</th>
                <th>الملاحظات</th>
                <th>حالة الحجز</th>
                <th>رقم التواصل</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var booking in bookings)
            {
                <tr class="@((booking.IsCanceled ? "canceled-row" : ""))">
                    <td>@booking.CountryName</td>
                    <td>@booking.TravelDate.ToShortDateString()</td>
                    <td>@booking.TravelDate.ToString("hh:mm tt")</td> @* 🕓 عرض وقت الرحلة *@
                    <td>@booking.SeatsRequested</td>
                    <td>@(string.IsNullOrWhiteSpace(booking.Notes) ? "-" : booking.Notes)</td>
                    <td>@(booking.IsCanceled ? "❌ ملغي" : "✅ نشط")</td>
                    <td>@booking.ContactPhone</td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    List<Booking>? bookings;

    protected override async Task OnInitializedAsync()
    {
        bookings = await SupabaseService.GetAllBookingsAsync();
    }
}
